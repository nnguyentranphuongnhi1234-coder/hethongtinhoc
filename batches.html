<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Qu·∫£n l√Ω L√¥ h√†ng</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
body {font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif; margin:0; padding:0; background:#e0f0f3; color:#333;}
header {background:#264d4d; color:#f0f0f0; padding:20px 0; text-align:center; display:flex; align-items:center; justify-content:center; gap:10px; box-shadow:0 4px 12px rgba(0,0,0,0.2);}
header h1 {margin:0; font-size:28px; font-weight:600; letter-spacing:1px;}
header i.logo-icon {font-size:32px; color:#8bc34a; animation:logoBounce 1s infinite alternate;}
@keyframes logoBounce {0%{transform:scale(1);}100%{transform:scale(1.1);}}
.back-btn {position:fixed; top:20px; left:20px; background:#4b636e; color:#fff; padding:8px 12px; border-radius:12px; text-decoration:none; font-weight:600; display:flex; align-items:center; gap:6px; box-shadow:0 4px 8px rgba(0,0,0,0.2); transition:all 0.3s;}
.back-btn:hover {transform:scale(1.05);} .back-btn:hover i{transform:translateX(-3px);}
.container {max-width:1200px; margin:25px auto; padding:25px; background:#fff; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.1);}
.form-group, .controls {display:flex; flex-wrap:wrap; gap:15px; margin-bottom:25px;}
.form-group input, .form-group select, .controls input, .controls select {flex:1; padding:12px; border-radius:10px; border:1px solid #ccc; transition:all 0.3s; font-size:15px;}
.form-group input:focus, .form-group select:focus, .controls input:focus, .controls select:focus {outline:none; border-color:#26a69a; box-shadow:0 0 8px rgba(38,166,154,0.4);}
button {padding:10px 18px; border-radius:12px; border:none; cursor:pointer; font-size:14px; font-weight:600; display:flex; align-items:center; gap:6px; transition:all 0.3s; box-shadow:0 4px 10px rgba(0,0,0,0.15);}
button i{transition:transform 0.3s;} button:hover i{transform:rotate(15deg);}
button.add{background:#6a11cb;color:#fff;} button.add:hover{transform:scale(1.08); box-shadow:0 8px 20px rgba(0,0,0,0.25);}
button.delete{background:#f85032;color:#fff;} button.delete:hover{transform:scale(1.08); box-shadow:0 8px 20px rgba(0,0,0,0.25);}
table{width:100%; border-collapse:collapse; margin-top:15px; font-size:14px;}
table th, table td{padding:12px; text-align:left; transition:all 0.3s;}
table th{background:#26a69a; color:#f0f0f0; letter-spacing:0.5px;}
table tr:nth-child(even){background:#f1f8f6;}
table tr:hover{background:#d1e8e2; transform:scale(1.01); box-shadow:0 4px 12px rgba(0,0,0,0.1);}
tr.fade-in{animation:fadeIn 0.6s ease forwards; opacity:0;}
@keyframes fadeIn{to{opacity:1;}}
.tag{display:inline-block; padding:5px 12px; border-radius:16px; font-size:12px; color:white; font-weight:500; margin:2px;}
.cert-vietgap{background:#ff9800;} .cert-globalgap{background:#8bc34a;} .not-certified{background:#757575;}
.status-pending{background:#9e9e9e;} .status-processing{background:#ffb74d;} .status-done{background:#4db6ac;}
.status-notstart{background:#e57373;} .status-shipping{background:#4dd0e1;} .status-delivered{background:#81c784;}
#map{height:450px; margin-top:25px; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.2);}
#details{margin-top:20px; padding:15px; background:#f5f7fa; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
</style>
</head>
<body>

<a href="javascript:history.back()" class="back-btn"><i class="fa fa-arrow-left"></i> Quay l·∫°i</a>

<header>
  <i class="fa fa-boxes logo-icon"></i>
  <h1>Qu·∫£n l√Ω L√¥ h√†ng</h1>
</header>

<div class="container">
  <div class="form-group">
    <input type="text" id="lotInput" placeholder="M√£ l√¥ h√†ng">
    <input type="text" id="typeInput" placeholder="Lo·∫°i l√¥ h√†ng">
    <input type="text" id="qtyInput" placeholder="S·ªë l∆∞·ª£ng (kg)">
    <input type="text" id="originInput" placeholder="Xu·∫•t x·ª©">
    <input type="text" id="destinationInput" placeholder="Giao ƒëi ƒë√¢u">
    <input type="text" id="shipperInput" placeholder="Shipper">
    <select id="certInput">
      <option value="Ch∆∞a">Ch∆∞a</option>
      <option value="VietGAP">VietGAP</option>
      <option value="GlobalGAP">GlobalGAP</option>
    </select>
    <select id="processInput">
      <option value="Ch∆∞a ch·∫ø bi·∫øn">Ch∆∞a ch·∫ø bi·∫øn</option>
      <option value="ƒêang ch·∫ø bi·∫øn">ƒêang ch·∫ø bi·∫øn</option>
      <option value="Ho√†n t·∫•t">Ho√†n t·∫•t</option>
    </select>
    <select id="shipInput">
      <option value="Ch∆∞a g·ª≠i">Ch∆∞a g·ª≠i</option>
      <option value="ƒêang v·∫≠n chuy·ªÉn">ƒêang v·∫≠n chuy·ªÉn</option>
      <option value="ƒê√£ giao">ƒê√£ giao</option>
    </select>
    <button class="add" onclick="addLot()"><i class="fa fa-plus"></i> Th√™m</button>
  </div>

  <div class="controls">
    <input type="text" id="searchInput" placeholder="üîç T√¨m theo m√£ l√¥...">
    <select id="filterSelect">
      <option value="all">üìã T·∫•t c·∫£</option>
      <option value="VietGAP">VietGAP</option>
      <option value="GlobalGAP">GlobalGAP</option>
      <option value="Ch∆∞a">Ch∆∞a</option>
    </select>
  </div>

  <table id="dataTable">
    <thead>
      <tr>
        <th>M√£ l√¥</th>
        <th>Lo·∫°i l√¥</th>
        <th>S·ªë l∆∞·ª£ng (kg)</th>
        <th>Xu·∫•t x·ª©</th>
        <th>Giao ƒëi ƒë√¢u</th>
        <th>Shipper</th>
        <th>Ch·ª©ng nh·∫≠n</th>
        <th>Ch·∫ø bi·∫øn</th>
        <th>V·∫≠n chuy·ªÉn</th>
        <th>H√†nh ƒë·ªông</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div id="map"></div>
  <div id="details"><b>Ch·ªçn m·ªôt l√¥ h√†ng ƒë·ªÉ xem chi ti·∫øt</b></div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const lots = [
  {lot:"L001", type:"C√† ph√™ nh√¢n", qty:100, origin:"ƒê·∫Øk L·∫Øk", destination:"Nh√† m√°y A", shipper:"Nguy·ªÖn VƒÉn A", cert:"VietGAP", process:"Ch∆∞a ch·∫ø bi·∫øn", ship:"Ch∆∞a g·ª≠i"},
  {lot:"L002", type:"H·∫°t ƒëi·ªÅu", qty:80, origin:"B√¨nh Ph∆∞·ªõc", destination:"Kho B", shipper:"Tr·∫ßn Th·ªã B", cert:"GlobalGAP", process:"ƒêang ch·∫ø bi·∫øn", ship:"ƒêang v·∫≠n chuy·ªÉn"},
  {lot:"L003", type:"L√∫a", qty:150, origin:"An Giang", destination:"Nh√† m√°y C", shipper:"L√™ VƒÉn C", cert:"Ch∆∞a", process:"Ho√†n t·∫•t", ship:"ƒê√£ giao"},
  {lot:"L004", type:"Tr√°i c√¢y", qty:50, origin:"L√¢m ƒê·ªìng", destination:"Kh√°ch h√†ng D", shipper:"Ph·∫°m VƒÉn D", cert:"VietGAP", process:"ƒêang ch·∫ø bi·∫øn", ship:"Ch∆∞a g·ª≠i"},
  {lot:"L005", type:"C√† ph√™ b·ªôt", qty:200, origin:"Gia Lai", destination:"Kho E", shipper:"Ho√†ng Th·ªã E", cert:"GlobalGAP", process:"Ch∆∞a ch·∫ø bi·∫øn", ship:"ƒêang v·∫≠n chuy·ªÉn"},
  {lot:"L006", type:"H·∫°t ƒëi·ªÅu", qty:60, origin:"B√¨nh Ph∆∞·ªõc", destination:"Nh√† m√°y F", shipper:"Nguy·ªÖn VƒÉn F", cert:"Ch∆∞a", process:"Ch∆∞a ch·∫ø bi·∫øn", ship:"Ch∆∞a g·ª≠i"},
  {lot:"L007", type:"Tr√°i c√¢y", qty:90, origin:"ƒê·∫Øk L·∫Øk", destination:"Kho G", shipper:"Tr·∫ßn Th·ªã G", cert:"VietGAP", process:"ƒêang ch·∫ø bi·∫øn", ship:"ƒêang v·∫≠n chuy·ªÉn"},
  {lot:"L008", type:"L√∫a", qty:70, origin:"An Giang", destination:"Kh√°ch h√†ng H", shipper:"L√™ VƒÉn H", cert:"GlobalGAP", process:"Ho√†n t·∫•t", ship:"ƒê√£ giao"},
  {lot:"L009", type:"C√† ph√™ nh√¢n", qty:110, origin:"Kon Tum", destination:"Nh√† m√°y I", shipper:"Ph·∫°m VƒÉn I", cert:"Ch∆∞a", process:"Ch∆∞a ch·∫ø bi·∫øn", ship:"Ch∆∞a g·ª≠i"},
  {lot:"L010", type:"Tr√°i c√¢y", qty:150, origin:"L√¢m ƒê·ªìng", destination:"Kho J", shipper:"Ho√†ng Th·ªã J", cert:"VietGAP", process:"ƒêang ch·∫ø bi·∫øn", ship:"ƒêang v·∫≠n chuy·ªÉn"}
];

const locations = {
  "ƒê·∫Øk L·∫Øk":[12.7,108.05], "B√¨nh Ph∆∞·ªõc":[11.75,106.8], "An Giang":[10.36,105.43],
  "L√¢m ƒê·ªìng":[11.94,108.44], "Gia Lai":[13.8,108.0], "Kon Tum":[14.35,107.98]
};

const tableBody=document.querySelector("#dataTable tbody");
const searchInput=document.getElementById("searchInput");
const filterSelect=document.getElementById("filterSelect");
const detailsDiv=document.getElementById("details");

const map = L.map('map').setView([13.0,107.5],6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OpenStreetMap contributors'}).addTo(map);
let markers=[];

function renderMap(){
  markers.forEach(m=>map.removeLayer(m));
  markers=[];
  lots.forEach((lot,index)=>{
    const coords=locations[lot.origin];
    if(coords){
      const m=L.marker(coords).addTo(map)
        .bindPopup(`<b>L√¥ ${lot.lot}</b><br>${lot.type}<br>S·ªë l∆∞·ª£ng: ${lot.qty}kg<br>Xu·∫•t x·ª©: ${lot.origin}<br>Giao ƒë·∫øn: ${lot.destination}<br>Shipper: ${lot.shipper}<br>Ch·ª©ng nh·∫≠n: ${lot.cert}<br>Ch·∫ø bi·∫øn: ${lot.process}<br>V·∫≠n chuy·ªÉn: ${lot.ship}`);
      m.on('click',()=>showDetails(index));
      markers.push(m);
    }
  });
}

function showDetails(index){
  const lot=lots[index];
  detailsDiv.innerHTML=`
    <b>Chi ti·∫øt l√¥ h√†ng ${lot.lot}:</b><br>
    Lo·∫°i l√¥ h√†ng: ${lot.type}<br>
    S·ªë l∆∞·ª£ng: ${lot.qty} kg<br>
    Xu·∫•t x·ª©: ${lot.origin}<br>
    Giao ƒë·∫øn: ${lot.destination}<br>
    Shipper: ${lot.shipper}<br>
    Ch·ª©ng nh·∫≠n: ${lot.cert}<br>
    Tr·∫°ng th√°i ch·∫ø bi·∫øn: ${lot.process}<br>
    Tr·∫°ng th√°i v·∫≠n chuy·ªÉn: ${lot.ship}
  `;
}

function renderTable(){
  const searchText=searchInput.value.toLowerCase();
  const filterValue=filterSelect.value;
  tableBody.innerHTML="";
  lots.filter(lot=>{
    const matchText=lot.lot.toLowerCase().includes(searchText);
    const matchFilter=filterValue==="all" || lot.cert===filterValue;
    return matchText && matchFilter;
  }).forEach((lot,index)=>{
    const row=document.createElement("tr"); row.classList.add("fade-in");
    let certClass=lot.cert==="VietGAP"?"cert-vietgap":lot.cert==="GlobalGAP"?"cert-globalgap":"not-certified";
    let processClass=lot.process==="Ch∆∞a ch·∫ø bi·∫øn"?"status-pending":lot.process==="ƒêang ch·∫ø bi·∫øn"?"status-processing":"status-done";
    let shipClass=lot.ship==="Ch∆∞a g·ª≠i"?"status-notstart":lot.ship==="ƒêang v·∫≠n chuy·ªÉn"?"status-shipping":"status-delivered";
    row.innerHTML=`
      <td>${lot.lot}</td>
      <td>${lot.type}</td>
      <td>${lot.qty}</td>
      <td>${lot.origin}</td>
      <td>${lot.destination}</td>
      <td>${lot.shipper}</td>
      <td><span class="tag ${certClass}">${lot.cert}</span></td>
      <td><span class="tag ${processClass}">${lot.process}</span></td>
      <td><span class="tag ${shipClass}">${lot.ship}</span></td>
      <td><button class="delete" onclick="deleteLot(${index})"><i class="fa fa-trash"></i> X√≥a</button></td>
    `;
    row.onclick=()=>showDetails(index);
    tableBody.appendChild(row);
  });
  renderMap();
}

function addLot(){
  const lot=document.getElementById("lotInput").value.trim();
  const type=document.getElementById("typeInput").value.trim();
  const qty=document.getElementById("qtyInput").value.trim();
  const origin=document.getElementById("originInput").value.trim();
  const destination=document.getElementById("destinationInput").value.trim();
  const shipper=document.getElementById("shipperInput").value.trim();
  const cert=document.getElementById("certInput").value;
  const process=document.getElementById("processInput").value;
  const ship=document.getElementById("shipInput").value;
  if(!lot || !type || !qty || !origin || !destination || !shipper){ alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!"); return;}
  lots.push({lot,type,qty,origin,destination,shipper,cert,process,ship});
  document.getElementById("lotInput").value="";
  document.getElementById("typeInput").value="";
  document.getElementById("qtyInput").value="";
  document.getElementById("originInput").value="";
  document.getElementById("destinationInput").value="";
  document.getElementById("shipperInput").value="";
  document.getElementById("certInput").value="Ch∆∞a";
  document.getElementById("processInput").value="Ch∆∞a ch·∫ø bi·∫øn";
  document.getElementById("shipInput").value="Ch∆∞a g·ª≠i";
  renderTable();
}

function deleteLot(i){ if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a l√¥ h√†ng n√†y?")){ lots.splice(i,1); renderTable(); } }

searchInput.addEventListener("input", renderTable);
filterSelect.addEventListener("change", renderTable);

renderTable();
</script>

</body>
</html>
